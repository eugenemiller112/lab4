---
title: "Team All Stars Lab 4"
author: "Johnny Tamanaha, Emily Archambault, Eugene Miller, Kaiyuan Fan, Jingzhi Zhang"
date: "9/20/2019"
output: html_document
---
```{r, setup, echo = FALSE, message = FALSE, warning = FALSE}
library(tidyverse)
babies <- read_csv("https://raw.githubusercontent.com/ervance1/Sp2018-Data-Science-repo/master/babies2a.dat")
babies <- rename(babies, bwtoz = `bwt/oz`) #renaming `bwt/oz` because the "/" sign requires special care

smoke.labs <- c("Nonsmoking", "Smoking")
names(smoke.labs) <- c("0", "1")
prem.labs <- c("Full Term", "Premature")
names(prem.labs) <- c("0", "1")
```

## Questions

Which variables are similar between smokers and nonsmokers? Which are different?
#Correlating Income
```{r, message = FALSE, warning = FALSE, fig.align='center'}
ggplot(subset(babies, smoke != "NA")) +
  geom_bar(mapping = aes(x = inc, y = ..prop.., fill = smoke == 1), position = "dodge", color = "black") +
  theme(text = element_text(hjust = 0.5, size = 9.5), plot.title = element_text(hjust = 0.5, size = 9.5)) +
  scale_y_continuous(labels=scales::percent) + 
  labs(x = "Income Groups", y = "Proportion", fill = "Smoker?", title = "Comparison of Income Across Smokers and Nonsmokers") +
  scale_fill_brewer(palette = 3)
```
#Correlating premature
```{r, message = FALSE, warning = FALSE, fig.align='center'}
ggplot(subset(babies, smoke != "NA")) + 
  geom_bar(mapping = aes(x = Premature, y = ..prop.., fill = smoke == 1), position = "dodge", color = "black") + 
  scale_y_continuous(labels=scales::percent) + 
  labs(y = "Percentage of Births", fill = "Is The Mother a Smoker?", x = "Normal Birth                                  Premature Birth", title = "Comparison of Percentage of Births That are Premature in Smoking and Nonsmoking Groups") +
  theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(), text = element_text(hjust = 0.5, size = 9.5), plot.title = element_text(hjust = 0.5, size = 9.5)) +
  scale_fill_brewer(palette = 3)
```

Do mothers who smoke have increased rates of premature delivery (before 270 days)?

Do the newborns of mothers who smoke have smaller birth weights at every gestational age (number of days into pregnancy when child is born)?

--- 

## Team Plot
Question 1:
```{r, message = FALSE, warning=FALSE}
ggplot(subset(babies,Premature!="NA" & smoke != "NA"), aes(smoke))  +
  geom_bar(aes(fill = Premature == 1), width=0.5)+
  labs(x= "Smoke", y="Count", fill = "premature people", title = "The Precentage of Premature Among Smokers and Nonsmokers ")+
  theme(text = element_text(face = "plain",colour = "black", size = 10, lineheight = 0.9,  hjust = 0.5),plot.title = element_text (hjust = 0.1,color="blue", size =6))+
  scale_fill_discrete(name="Premature",breaks=c("FALSE", "TRUE"),labels=c("Full term", "Premature"))

```


Question 2:

```{r, message = FALSE, warning = FALSE, fig.align='center'}
ggplot(subset(babies, smoke != "NA")) +
  geom_jitter(mapping = aes(y = bwtoz, x = gestation)) +
  geom_smooth(mapping = aes(y = bwtoz, x = gestation, color = smoke == 1), method = lm, se = FALSE) +
  coord_cartesian(xlim = c(200,300))+
  labs(y = "Weight (oz)", x = "Gestation Period (Days)", title = "Comparison of Baby Weight Distribution Between Smoking and Nonsmoking Mothers", color = "") +
  theme(text = element_text(hjust = 0.5, size = 9.5), plot.title = element_text(hjust = 0.5, size = 9.5)) +
  scale_color_discrete(name="",
                        breaks=c("FALSE", "TRUE"),
                        labels=c("Nonsmoking", "Smoking"))
```
---

## Conclusions

Do mothers who smoke have increased rates of premature delivery (before 270 days)?

Do the newborns of mothers who smoke have smaller birth weights at every gestational age (number of days into pregnancy when child is born)?

---

## Recommendation 

---

## Individual Sections


### Eugene Miller

```{r, message = FALSE, warning = FALSE, fig.align='center'}
ggplot(subset(babies, Premature != "NA" & smoke != "NA")) + 
  geom_bar(mapping = aes(x = parity, y = ..prop.., fill = smoke == 1), show.legend = FALSE, color = "black") + 
  facet_wrap(Premature~smoke, labeller = labeller(smoke = smoke.labs, Premature = prem.labs)) + 
  theme(text = element_text(hjust = 0.5, size = 9.5), plot.title = element_text(hjust = 0.5, size = 9.5)) +
  labs(x = "Number of Mother's Previous Pregnancies", y = "Proportion of Babies Born", title = "Comparison of Previous Pregnancies Across Pregnancy Period and Mother's Smoking Status") +
  scale_fill_brewer(palette = 3)
```

This shows that amongst both full term and premature births, smoking is correlated with a higher average number of previous pregnancies that the mother has had. This suggests that smoking increases the chance of a failed pregnancy; a pregnancy that results in the fetus dying before it is born. Therefore, as smoking is correlated with a higher preportion of failed pregnancies, I recommend that we try to reduce the amount of smoking in order to reduce the number of failed pregnancies, which places stress of mothers who are trying to concieve a child.

---

## Individual Contribution Summaries
